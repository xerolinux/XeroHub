{{/* Shortcode: changelog
     Renders button + modal and loads assets/changelog.md as markdown */}}

<div align="center" style="margin: 2rem 0;">
  <button
    type="button"
    onclick="document.getElementById('xero-changelog-modal').showModal()"
    style="
      padding: 0.6rem 1.4rem;
      border-radius: 0.75rem;
      border: 1px solid rgba(120,120,120,0.6);
      background: transparent;
      cursor: pointer;
      font-weight: 600;
    "
  >
    View The XeroLinux Changelog
  </button>
</div>

<style>
  /* ---------- Dialog container, force center ---------- */
  #xero-changelog-modal {
    border: none;
    padding: 0;
    width: min(860px, 96vw);
    background: transparent;

    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  /* Dark blur behind popup */
  #xero-changelog-modal::backdrop {
    background: rgba(10, 12, 18, 0.75);
    backdrop-filter: blur(6px);
  }

  /* ---------- Modal card ---------- */
  .xero-changelog-card {
    display: flex;
    flex-direction: column;
    margin: 0;
    padding: 0;
    border-radius: 1rem;

    background: linear-gradient(
      135deg,
      rgba(65, 105, 225, 0.97) 0%,
      rgba(138, 43, 226, 0.97) 100%
    );

    color: #f0f4ff;
    max-height: 86vh;
    overflow-y: auto;
    box-shadow:
      0 25px 60px rgba(0, 0, 0, 0.55),
      0 0 0 1px rgba(255,255,255,0.1);
  }

  /* ---------- Header ---------- */
  .xero-changelog-header {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    padding: 1.1rem 1.5rem;
    margin: 0;

    background: linear-gradient(
      120deg,
      rgba(255, 255, 255, 0.28),
      rgba(255, 255, 255, 0.10)
    );

    color: #0b1020;
    border-bottom: 1px solid rgba(255,255,255,0.3);
    border-top-left-radius: 1rem;
    border-top-right-radius: 1rem;
  }

  .xero-changelog-header h3 {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }

  /* Accent bar separator */
  .xero-changelog-accent {
    height: 3px;
    background: linear-gradient(
      90deg,
      rgba(59, 130, 246, 0.9),
      rgba(168, 85, 247, 0.9),
      rgba(236, 72, 153, 0.9)
    );
  }

  /* ---------- BODY (darker translucent glass) ---------- */
  .xero-changelog-body {
    padding: 1.4rem 1.5rem;
    text-align: left;

    background: rgba(5, 8, 20, 0.32);
    backdrop-filter: blur(10px);

    border-bottom-left-radius: 1rem;
    border-bottom-right-radius: 1rem;

    box-shadow:
      inset 0 0 0 1px rgba(255,255,255,0.06),
      inset 0 0 18px rgba(0,0,0,0.18);
  }

  /* Title inside markdown (# Recent Updates) */
  .xero-changelog-md h1 {
    margin-top: 0;
    margin-bottom: 0.9rem;
    font-size: 1.6rem;
    font-weight: 800;
    color: #ffffff;
  }

  .xero-changelog-body p {
    margin-top: 0;
    margin-bottom: 1rem;
    color: #f1f4ff;
  }

  /* ---------- Top-level list: one card per update ---------- */
  .xero-changelog-md > ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .xero-changelog-md > ul > li {
    padding: 0.85rem 1rem;
    border-radius: 0.9rem;
    border: 1px solid rgba(255, 255, 255, 0.22);
    background: rgba(15, 23, 42, 0.75);
    box-shadow:
      0 10px 20px rgba(0, 0, 0, 0.35);
  }

  /* Date label: first paragraph's strong */
  .xero-changelog-md > ul > li > p:first-child strong {
    display: block;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    opacity: 0.95;
    margin-bottom: 0.35rem;
  }

  /* Remove extra bottom margin on that date paragraph */
  .xero-changelog-md > ul > li > p:first-child {
    margin-bottom: 0.25rem;
  }

  /* ---------- Inner bullet list (the actual changes) ---------- */
  .xero-changelog-md > ul > li > ul {
    margin: 0.25rem 0 0;
    padding-left: 1.1rem;
  }

  .xero-changelog-md > ul > li > ul > li {
    list-style: disc;
    padding: 0.12rem 0;
    border: none;
    background: transparent;
    box-shadow: none;
    border-radius: 0;
    color: #e5ebff;
    font-size: 0.9rem;
    line-height: 1.45;
  }

  /* ---------- Footer ---------- */
  .xero-changelog-footer {
    padding: 1rem 1.5rem 1.1rem;
    display: flex;
    justify-content: flex-end;

    border-top: 1px solid rgba(255,255,255,0.22);
    background: rgba(0,0,0,0.10);

    border-bottom-left-radius: 1rem;
    border-bottom-right-radius: 1rem;
  }

  .xero-changelog-footer button {
    padding: 0.45rem 1.1rem;
    border-radius: 999px;
    border: none;
    background: rgba(255,255,255,0.25);
    color: #111827;
    cursor: pointer;
    font-size: 0.86rem;
    transition: background 0.2s, transform 0.1s;
  }

  .xero-changelog-footer button:hover {
    background: rgba(255,255,255,0.35);
    transform: translateY(-1px);
  }

  /* ---------- Mobile tweaks ---------- */
  @media (max-width: 640px) {
    #xero-changelog-modal {
      width: 94vw;
    }

    .xero-changelog-header,
    .xero-changelog-body,
    .xero-changelog-footer {
      padding: 0.9rem 1rem;
    }

    .xero-changelog-header h3 {
      font-size: 1.05rem;
    }

    .xero-changelog-md > ul > li {
      padding: 0.75rem 0.85rem;
    }
  }
</style>


<dialog id="xero-changelog-modal">
  <form method="dialog" class="xero-changelog-card">

    <!-- Header -->
    <header class="xero-changelog-header">
      <h3>
        <span>ðŸ”§</span>
        <span>XeroLinux Changelog</span>
      </h3>
    </header>

    <div class="xero-changelog-accent"></div>

    <!-- BODY loads Markdown file directly -->
    <section class="xero-changelog-body">
      {{ with readFile "assets/changelog.md" }}
        <div class="xero-changelog-md">
          {{ . | markdownify }}
        </div>
      {{ else }}
        <p>No changelog available.</p>
      {{ end }}
    </section>

    <footer class="xero-changelog-footer">
      <button type="submit">Close</button>
    </footer>

  </form>
</dialog>

<script>
  (function () {
    const dlg = document.getElementById('xero-changelog-modal');
    if (!dlg) return;
    dlg.addEventListener('click', (event) => {
      if (event.target === dlg) dlg.close();
    });
  })();
</script>
